<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Engineering Task Management | My Tasks</title>
<link rel="stylesheet" href="/css/all.min.css">
<link rel="stylesheet" href="/fonts/inter/inter.css">
  <link rel="stylesheet" href="/styles/userpage.css">
  <link rel="stylesheet" href="/styles/utils.css">

</head>
<body data-user-id="<%= user.id %>" data-dept-id="<%= user.DepartmentId %>" data-task-list="<%= JSON.stringify(tasks) %>" data-is-admin="<%= user.usrAdmin || false %>">
  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <img src="/images/accLogo.png" alt="Company Logo" class="sidebar-logo">
    </div>
    
    <div class="sidebar-user">
      <div class="sidebar-user-avatar">RK</div>
      <div class="sidebar-user-info">
        <h4><%=user.name %></h4>
<p>
  <% if (user.DeptName) { %>
    <%= user.DeptName %> Department
  <% } else { %>
    Admin
  <% } %>
</p>
      </div>
    </div>
    
    <nav class="sidebar-nav">
      <a href="/workflowdashboard" class="active">
        <i class="fas fa-tachometer-alt"></i>
        Dashboard
      </a>

      <a href="/task-selected">
        <i class="fas fa-tasks"></i>
        View Tasks
      </a>
      <a href="#">
        <i class="fas fa-project-diagram"></i>
        Projects
      </a>
      <a href="#">
        <i class="fas fa-calendar-alt"></i>
        Schedule
      </a>
      <a href="#">
        <i class="fas fa-chart-line"></i>
        Reports
      </a>
      <a href="#">
        <i class="fas fa-cog"></i>
        Settings
      </a>
    </nav>
    
    <div class="sidebar-footer">
      <button class="logout-btn" id="sidebarLogoutBtn">
        <i class="fas fa-sign-out-alt"></i>
        Logout
      </button>
    </div>
  </aside>

  <!-- Main Content Area -->
  <main class="main-content">
    <!-- Top Header -->
    <header class="top-header">
      <div class="breadcrumb">
        <a href="/workFlowDash">
          <i class="fas fa-home"></i>
          Dashboard
        </a>
        
        <span class="breadcrumb-separator">/</span>
        <span>My Tasks</span>
      </div>
      
      <div class="header-actions">
        <button class="back-button" id="backBtn">
          <i class="fas fa-arrow-left"></i>
          Back to Dashboard
        </button>
        <a href="/logout">
  <i class="fas fa-sign-out-alt"></i>
  Logout
</a>

      </div>
      
    </header>

    <!-- Content Area -->
    <div class="content-area">
      <section class="task-management">
        <div class="task-header">
          <h2>
            <i class="fas fa-tasks"></i>
            Task Management
          </h2>
          
          <div class="progress-indicator">
            <span>Task Completion:</span>
            <div class="progress-bar">
              <div class="progress-fill" id="completion-progress"></div>
            </div>
            <span id="completion-percentage">0%</span>
          </div>
        </div>
        
        <!-- Task Timeline Visualization -->
        <div class="task-timeline" id="task-timeline">
          <!-- Timeline items will be inserted here by JavaScript -->
        </div>
        
        <!-- Task Filters -->
        <div class="task-filters">
          <div class="filter-group">
            <label class="filter-label">Filter by:</label>
            <select id="status-filter" class="filter-select">
              <option value="all">All Tasks</option>
              <option value="pending">Pending</option>
              <option value="inprogress">In Progress</option>
              <option value="completed">Completed</option>
              <option value="overdue">Overdue</option>
            </select>
          </div>
          
        
          <div class="search-container">
            <input type="text" id="task-search" class="search-input" placeholder="Search tasks...">
            <button id="search-btn" class="search-btn">
              <i class="fas fa-search"></i>
              Search
            </button>
          </div>
        </div>
        
        <!-- Status Quick View -->
        <div class="status-quickview">
          <div class="status-item" data-filter="all">
            <span class="status-badge"></span>
            <span>All Tasks</span>
            <span class="status-count" id="total-count">0</span>
          </div>
          <div class="status-item" data-filter="pending">
            <span class="status-badge status-pending"></span>
            <span>Pending</span>
            <span class="status-count" id="pending-count">0</span>
          </div>
          <div class="status-item" data-filter="inprogress">
            <span class="status-badge status-inprogress"></span>
            <span>In Progress</span>
            <span class="status-count" id="inprogress-count">0</span>
          </div>
          <div class="status-item" data-filter="completed">
            <span class="status-badge status-completed"></span>
            <span>Completed</span>
            <span class="status-count" id="completed-count">0</span>
          </div>
          <div class="status-item" data-filter="overdue">
            <span class="status-badge status-overdue"></span>
            <span>Overdue</span>
            <span class="status-count" id="overdue-count">0</span>
          </div>
        </div>
        
        <div class="process-info">
          <div class="info-item">
            <span class="info-label">
              <i class="fas fa-project-diagram"></i>
              Process
            </span>
            <span class="info-value"><%= (typeof tasks !== 'undefined' && tasks && tasks[0]) ? tasks[0].ProcessName : 'N/A' %></span>
          </div>
          <div class="info-item">
            <span class="info-label">
              <i class="fas fa-folder"></i>
              Project
            </span>
            <span class="info-value"><%= (typeof tasks !== 'undefined' && tasks && tasks[0]) ? tasks[0].ProjectName : 'N/A' %></span>
          </div>
          <div class="info-item">
            <span class="info-label">
              <i class="fas fa-box"></i>
              Package
            </span>
            <span class="info-value"><%= (typeof tasks !== 'undefined' && tasks && tasks[0]) ? tasks[0].PkgeName : 'N/A' %></span>
          </div>
        </div>
        
        <div id="department-tables-container">
          <!-- Department tables will be inserted here by JavaScript -->
        </div>
      </section>
    </div>
  </main>

  <!-- Success Message -->
  <div id="success-message" class="success-message message">
    <i class="fas fa-check-circle"></i>
    <span id="success-text"></span>
  </div>

  <!-- Error Message -->
  <div id="error-message" class="error-message message">
    <i class="fas fa-exclamation-circle"></i>
    <span id="error-text"></span>
  </div>

  <!-- Confirmation Modal -->
  <div id="confirmation-modal" class="modal">
    <div class="modal-content">
      <h3 class="modal-title">
        <i class="fas fa-question-circle"></i>
        <span id="modal-message">Are you sure you want to perform this action?</span>
      </h3>
      <div class="modal-actions">
        <button id="modal-confirm-btn" class="modal-confirm-btn">Confirm</button>
        <button id="modal-cancel-btn" class="modal-cancel-btn">Cancel</button>
      </div>
    </div>
  </div>
  <!-- EJS Variables for External JavaScript -->

  <script src="/js/userpage.js"></script>
</body>
</html>
